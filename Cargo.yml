package:

  name   : thespis_impl
  version: 0.1.0
  authors: [ Naja Melan <najamelan@autistici.org> ]
  edition: '2018'

  metadata:
    docs.rs:
      all-features: true

lib:

  bench: false


features:

  default: [ tokio, remote, ws         ]
  ws     : [ remote, tokio-tungstenite ]
  tcp    : [ remote, tokio/tcp         ]

  remote :

    - serde
    - serde_cbor
    - thespis/remote
    - bytes
    - hashbrown
    - num-derive
    - num-traits
    - twox-hash
    - byteorder
    - rand


dependencies:

  # crossbeam-channel: { path: ../../crossbeam-channel, features: [ async  ]                          }
  thespis             : { path: ../thespis_iface }
  failure             : ^0.1
  futures-preview     : { version: ^0.3.0-alpha.14, features: [ std, compat, nightly ], default-features: false }
  log                 : ^0.4
  simple_logger       : ^1
  regex               : { version: ^1, features: [ pattern ] }

  # tokio stuff
  #
  once_cell           : ^0.1

  tokio:

    path             : ../../tokio/tokio
    features         : [ async-await-preview, rt-full, codec ]
    default-features : false
    optional         : true


  # remote stuff
  #
  serde_cbor        : { version: ^0.9, optional: true                                                }
  serde             : { version: ^1  , optional: true, default-features: false, features: [ derive ] }
  tokio-tungstenite : { version: ^0.6, optional: true                                                }
  bytes             : { version: ^0.4, optional: true                                                }
  num-traits        : { version: ^0.2, optional: true                                                }
  num-derive        : { version: ^0.2, optional: true                                                }
  twox-hash         : { version: ^1.1, optional: true                                                }
  byteorder         : { version: ^1.3, optional: true                                                }
  rand              : { version: ^0.6, optional: true, default-features: false                       }
  hashbrown         : { version: ^0.2, optional: true, default-features: false, features: [ nightly ] }

dev-dependencies:

  actix            : ^0.7.9
  criterion        : { version: ^0.2                 , features: [ real_blackbox        ]                          }
  futures-preview  : { version: ^0.3.0-alpha.14, features: [ std, compat, nightly ], default-features: false }
  tokio            : { path: ../../tokio/tokio , features: [ async-await-preview, rt-full, tcp, codec ], default-features: false }
  pretty_assertions: ^0.6
  serde_cbor       : ^0.9
  flexi_logger        : ^0.11


bench:

  - name   : single_thread_delivery
    path   : benches/single_thread/delivery.rs
    harness: false

  - name   : multi_thread_delivery
    path   : benches/multi_thread/delivery.rs
    harness: false

example:

  # Single thread
  #
  - name   : single_thread_basic
    path   : examples/single_thread/basic.rs

  - name   : single_thread_across
    path   : examples/single_thread/across_yields.rs

  - name   : single_thread_recipient
    path   : examples/single_thread/recipient.rs

  - name   : single_thread_perf
    path   : examples/single_thread/perf.rs

  - name   : single_thread_no_rt
    path   : examples/single_thread/no_rt.rs

  # - name             : remote
  #   path             : examples/single_thread/remote/src/peera.rs
  #   required-features: [ remote ]

  - name             : single_thread_tokio
    path             : examples/single_thread/tokio.rs
    required-features: [ tokio ]


  # Multi thread
  #
  - name   : multi_thread_basic
    path   : examples/multi_thread/basic.rs

  - name   : multi_thread_move_fut
    path   : examples/multi_thread/move_fut.rs


profile:

  release:

    opt-level    : 3
    codegen-units: 1

    lto          : false
    debug        : true
